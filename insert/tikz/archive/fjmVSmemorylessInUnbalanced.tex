\begin{figure}
\centering
\begin{subfigure}{0.45\textwidth}
    \centering
		\begin{tikzpicture}[scale=.85]
				\draw (5,4) node[shape star] (54) {};
				\draw (5,3) node[shape star] (53) {};
				\draw (5,2) node[shape star] (52) {};
				\draw (5,1) node[shape star] (51) {};
				\draw (4,4) node[shape dot] (44) {};
				\draw (4,3) node[shape dot] (43) {};
				\draw (4,2) node[shape dot] (42) {};
				\draw (4,1) node[shape dot] (41) {};
				\draw (3,4) node[shape dot] (34) {};
				\draw (3,3) node[shape dot] (33) {};
				\draw (3,2) node[shape dot] (32) {};
				\draw (3,1) node[shape dot] (31) {};
				\draw (2,4) node[shape dot] (24) {};
				\draw (2,3) node[shape dot] (23) {};
				\draw (2,2) node[shape dot] (22) {};
				\draw (2,1) node[shape dot] (21) {};
				\draw (1,4) node[shape dot] (14) {};
				\draw (1,3) node[shape dot] (13) {};
				\draw (1,2) node[shape dot] (12) {};
				\draw (1,1) node[shape dot] (11) {};
				\draw (0,4) node[shape dot, color=blue] (04) {};
				\draw (0,3) node[shape dot, color=blue] (03) {};
				\draw (0,2) node[shape dot, color=blue] (02) {};
				\draw (0,1) node[shape dot, color=blue] (01) {};
				\draw (-1,4) node[shape square, color=blue] (4) {};
				\draw (-1,3) node[shape square, color=blue] (3) {};
				\draw (-1,2) node[shape square, color=blue] (2) {};
				\draw (-1,1) node[shape square, color=blue] (1) {};
				
				\draw (1,-.5) node[shape dot, color=red] (1m1) {};
				\draw (2,-.5) node[shape dot, color=red] (2m1) {};
				\draw (3,-.5) node[shape dot, color=red] (3m1) {};
				\draw (4,-.5) node[shape dot, color=red] (4m1) {};
				\draw (5,-.5) node[shape dot, color=red] (5m1) {};
				\draw[-latex, thick, color=red] (1m1) -- (2m1);
				\draw[-latex, thick, color=red] (2m1) -- (3m1);
				\draw[-latex, thick, color=red] (3m1) -- (4m1);
				\draw[-latex, thick, color=red] (4m1) -- (5m1);

				\draw[-latex, thick] (1) -- (01);
				\draw[-latex, thick] (2) -- (02);
				\draw[-latex, thick] (3) -- (03);
				\draw[-latex, thick] (4) -- (04);
				\draw[-latex, thick] (01) -- (11);
				\draw[-latex, thick] (02) -- (12);
				\draw[-latex, thick] (03) -- (13);
				\draw[-latex, thick] (04) -- (14);
				\draw[-latex, thick] (11) -- (21);
				\draw[-latex, thick] (12) -- (22);
				\draw[-latex, thick] (13) -- (23);
				\draw[-latex, thick] (14) -- (24);
				\draw[-latex, thick] (21) -- (31);
				\draw[-latex, thick] (22) -- (32);
				\draw[-latex, thick] (23) -- (33);
				\draw[-latex, thick] (24) -- (34);
				\draw[-latex, thick] (31) -- (41);
				\draw[-latex, thick] (32) -- (42);
				\draw[-latex, thick] (33) -- (43);
				\draw[-latex, thick] (34) -- (44);
				\draw[-latex, thick] (41) -- (51);
				\draw[-latex, thick] (42) -- (52);
				\draw[-latex, thick] (43) -- (53);
				\draw[-latex, thick] (44) -- (54);
				
				\draw[-latex, thick, <->] (1,4.7) -- (5,4.7);
				\node[text width=.4cm,fill=white] at (3,4.7) {$D'$};
			
				\draw[-latex, thick, <->] (-1,5.2) -- (5,5.2);
				\node[text width=.3cm,fill=white] at (2,5.2) {$D$};
			
				\draw[-latex, thick, <->] (-2,1) -- (-2,4);
				\node[text width=.3cm,fill=white] at (-2,2.5) {$M$};
			
			\end{tikzpicture}
			\caption{Original attack when $D'<D$: blue points are useless because they
			will never make the $p$-chain reach any stored points}
    \label{fig:unbalancedoriginal}
\end{subfigure}
\hfill
\begin{subfigure}{0.45\textwidth}
 		\begin{tikzpicture}[scale=.85]
				\draw (5,4) node[shape dot] (54) {};
				\draw (5,3) node[shape dot] (53) {};
				\draw (5,2) node[shape dot] (52) {};
				\draw (5,1) node[shape dot] (51) {};
				\draw (4,4) node[shape dot] (44) {};
				\draw (4,3) node[shape dot] (43) {};
				\draw (4,2) node[shape dot] (42) {};
				\draw (4,1) node[shape dot] (41) {};
				\draw (3,4) node[shape dot] (34) {};
				\draw (3,3) node[shape dot] (33) {};
				\draw (3,2) node[shape dot] (32) {};
				\draw (3,1) node[shape dot] (31) {};
				\draw (2,4) node[shape dot] (24) {};
				\draw (2,3) node[shape dot] (23) {};
				\draw (2,2) node[shape dot] (22) {};
				\draw (2,1) node[shape dot] (21) {};
				\draw (1,4) node[shape dot] (14) {};
				\draw (1,3) node[shape dot] (13) {};
				\draw (1,2) node[shape dot] (12) {};
				\draw (1,1) node[shape dot] (11) {};
				\draw (0,4) node[shape dot] (04) {};
				\draw (0,3) node[shape dot] (03) {};
				\draw (0,2) node[shape dot] (02) {};
				\draw (0,1) node[shape dot] (01) {};
				\draw (-1,4) node[shape dot] (4) {};
				\draw (-1,3) node[shape dot] (3) {};
				\draw (-1,2) node[shape dot] (2) {};
				\draw (-1,1) node[shape dot] (1) {};
				
				\draw (1,5.5) node[shape square, color=red] (1m1) {};
				\draw (2,5.5) node[shape dot, color=red] (2m1) {};
				\draw (3,5.5) node[shape dot, color=red] (3m1) {};
				\draw (4,5.5) node[shape dot, color=red] (4m1) {};
				\draw (5,5.5) node[shape star, color=red] (5m1) {};
				\draw[-latex, thick, color=red] (1m1) -- (2m1);
				\draw[-latex, thick, color=red] (2m1) -- (3m1);
				\draw[-latex, thick, color=red] (3m1) -- (4m1);
				\draw[-latex, thick, color=red] (4m1) -- (5m1);

				\draw[-latex, thick] (1) -- (01);
				\draw[-latex, thick] (2) -- (02);
				\draw[-latex, thick] (3) -- (03);
				\draw[-latex, thick] (4) -- (04);
				\draw[-latex, thick] (01) -- (11);
				\draw[-latex, thick] (02) -- (12);
				\draw[-latex, thick] (03) -- (13);
				\draw[-latex, thick] (04) -- (14);
				\draw[-latex, thick] (11) -- (21);
				\draw[-latex, thick] (12) -- (22);
				\draw[-latex, thick] (13) -- (23);
				\draw[-latex, thick] (14) -- (24);
				\draw[-latex, thick] (21) -- (31);
				\draw[-latex, thick] (22) -- (32);
				\draw[-latex, thick] (23) -- (33);
				\draw[-latex, thick] (24) -- (34);
				\draw[-latex, thick] (31) -- (41);
				\draw[-latex, thick] (32) -- (42);
				\draw[-latex, thick] (33) -- (43);
				\draw[-latex, thick] (34) -- (44);
				\draw[-latex, thick] (41) -- (51);
				\draw[-latex, thick] (42) -- (52);
				\draw[-latex, thick] (43) -- (53);
				\draw[-latex, thick] (44) -- (54);
				
				\draw[-latex, thick, <->] (1,6.2) -- (5,6.2);
				\node[text width=.4cm,fill=white] at (3,6.2) {$D'$};
			
				\draw[-latex, thick, <->] (-1,6.7) -- (5,6.7);
				\node[text width=.3cm,fill=white] at (2,6.7) {$D$};
			
				\draw[-latex, thick, <->] (-2,1) -- (-2,4);
				\node[text width=.3cm,fill=white] at (-2,2.5) {$M$};
			
		\end{tikzpicture}
			\caption{Memoryless attack when $D'<D$: this time, the extra computation
			is useful, but the Matrix Stopping Rule does not apply (see below)}
    \label{fig:unbalancedmemoryless}
\end{subfigure}
\caption{Asymmetry between the original and the memoryless (unbalanced) attack
when $D'<D$}
\label{fig:assymetry}
\end{figure}



