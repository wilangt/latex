%!TEX root=../../main.tex

%------------------------------------------------------------------------------%
% Dependency                                                                   %
% - math.tex                                                                   %
%------------------------------------------------------------------------------%

%------------------------------------------------------------------------------%
% Packages                                                                     %
%------------------------------------------------------------------------------%

\usepackage[lambda, n, operators]{cryptocode}


%------------------------------------------------------------------------------%
% Form and style                                                               %
% \renewcommand at the beginning to change style for whole document            %
% (the space at the begining of the lines is on purpose)                       %
%------------------------------------------------------------------------------%

 \newcommand{\styleDistrib}[1]{\ensuremath{\mathcal{#1}}\xspace}
 \newcommand{\styleSampleFrom}[1]{\ensuremath{\xleftarrow{\$} #1}\xspace}
 \newcommand{\styleSampleUnif}[1]{\styleSampleFrom{\mathcal{U}\parentheses{#1}}}
 \newcommand{\styleGetFromPPT}{\ensuremath{\xleftarrow{\$}}\xspace}
 \newcommand{\styleAdv}[1]{\ensuremath{\mathcal{#1}}\xspace}
 \newcommand{\styleOracle}[1]{\ensuremath{\mathcal{#1}}\xspace}
 \newcommand{\styleEvent}[1]{\ensuremath{\mathsf{#1}}\xspace}
 \newcommand{\styleVarEvent}[1]{\ensuremath{\mathsf{#1}}\xspace}
 \newcommand{\styleGame}[1]{\ensuremath{\mathbf{#1}}\xspace}
 \newcommand{\styleClassProblem}[1]{\ensuremath{\mathsf{#1}}\xspace}
 \newcommand{\styleHardProblem}[1]{\texorpdfstring{\ensuremath{\textsf{#1}}}{#1}\xspace}
 \newcommand{\styleCryptAlgo}[1]{\ensuremath{\mathsf{#1}}\xspace}
 \newcommand{\styleBlockCipher}[1]{\ensuremath{\mathcal{#1}}\xspace}
 \newcommand{\stylePropertyAlgo}[1]{\ensuremath{\textsf{#1}}\xspace}
 \newcommand{\styleCryptVar}[1]{\ensuremath{\mathsf{#1}}\xspace}
 \newcommand{\styleSmallStateWit}[1]{\ensuremath{#1}\xspace}
 \newcommand{\styleBigStateWit}[1]{\ensuremath{\mathbb{#1}}\xspace}
 \newcommand{\styleSecurityModel}[1]{\ensuremath{\mathsf{#1}}\xspace}
 \newcommand{\styleCryptSet}[1]{\ensuremath{\mathcal{#1}}\xspace}

%------------------------------------------------------------------------------%
% Macros                                                                       %
%------------------------------------------------------------------------------%

% General
\renewcommand{\secpar}{\ensuremath{\lambda}\xspace}
\newcommand{\bit}{\ensuremath{\{0,1\}}\xspace}
\newcommand{\poly}{\ensuremath{\mathsf{poly}}\xspace}
\newcommand{\eps}{\varepsilon}

% Adversaries
\newcommand{\AdvA}{\styleAdv{A}}
\newcommand{\AdvB}{\styleAdv{B}}
\newcommand{\AdvC}{\styleAdv{C}}
\newcommand{\AdvD}{\styleAdv{D}}
\newcommand{\Adv}[1]{\styleAdv{#1}}

\newcommand{\timeAdv}{\ensuremath{t}}
\newcommand{\advAdv}{\ensuremath{\varepsilon}}

% Oracles
\newcommand{\OracleO}{\styleOracle{O}}
\newcommand{\Oracle}[1]{\styleOracle{#1}}
\newcommand{\OracleAccess}[2]{#1^{#2}}

% Distributions
\newcommand{\DistD}{\styleDistrib{D}}
\newcommand{\DistH}{\styleDistrib{H}}
\newcommand{\DistS}{\styleDistrib{S}}
\newcommand{\DistL}{\styleDistrib{L}}
\newcommand{\Dist}[1]{\styleDistrib{#1}}

% Samples
\newcommand{\sampleFrom}[1]{\styleSampleFrom{#1}}
\newcommand{\getsr}[1]{\styleGetFromPPT{#1}}
\newcommand{\Unif}[1]{\styleSampleUnif{#1}}

% Events, Games, View (cf math.tex)
\newcommand{\Good}{\styleEvent{Good}}
\newcommand{\Bad}{\styleEvent{Bad}}
\newcommand{\Hyb}{\styleEvent{Hyb}}
\newcommand{\Exp}{\styleEvent{Exp}}
\newcommand{\EventE}{\styleVarEvent{E}}

\newcommand{\equivStat}{\ensuremath{\overset{\mathsf{stat}}{\equiv}}\xspace}
\newcommand{\equivComp}{\ensuremath{\overset{\mathsf{comp}}{\equiv}}\xspace}
\newcommand{\View}{\ensuremath{\textsc{View}}\xspace}

\newcommand{\CryptoGame}{\styleGame{G}}
\newcommand{\Gamei}[1]{\ensuremath{\CryptoGame_{#1}}\xspace}

% Class of problems
\newcommand{\BPP}{\styleClassProblem{BPP}}
\newcommand{\NP}{\styleClassProblem{NP}}
\newcommand{\coNP}{\styleClassProblem{coNP}}
\newcommand{\PSPACE}{\styleClassProblem{PSPACE}}
\newcommand{\NC}{\styleClassProblem{NC}}
\newcommand{\IP}{\styleClassProblem{IP}}
\newcommand{\AM}{\styleClassProblem{AM}}
\newcommand{\CZK}{\styleClassProblem{CZK}}

% Computationnal assumptions and hard problems
\newcommand{\SEDL}{\styleHardProblem{SEDL}}
\newcommand{\DL}{\styleHardProblem{DL}}
\newcommand{\DLOG}{\styleHardProblem{DLOG}}
\newcommand{\DDH}{\styleHardProblem{DDH}}
\newcommand{\kerDH}{\styleHardProblem{kerDH}}
\newcommand{\DHP}{\styleHardProblem{DH}}
\newcommand{\DLin}{\styleHardProblem{DLin}}
\newcommand{\XDH}{\styleHardProblem{XDH}}
\newcommand{\CDH}{\styleHardProblem{CDH}}
\newcommand{\CoGDH}{\styleHardProblem{Co-GDH}}
\newcommand{\LWE}{\styleHardProblem{LWE}}
\newcommand{\SXDH}{\styleHardProblem{SXDH}}
\newcommand{\DCR}{\styleHardProblem{DCR}}


%%%%%%%%%%%%%%%%%%% Algorithms, schemes and primitives %%%%%%%%%%%%%%%%%%%%%%%%%

% General
\newcommand{\Algo}[1]{\styleCryptAlgo{#1}}
\newcommand{\Rand}{\styleCryptAlgo{Rand}}

% Primitives
\newcommand{\Setup}{\styleCryptAlgo{Setup}}
\newcommand{\GroupGen}{\styleCryptAlgo{BilinearGen}}
\newcommand{\DDHGen}{\styleCryptAlgo{DHGen}}
\newcommand{\PGen}{\styleCryptAlgo{PGen}}

\newcommand{\KeyGen}{\styleCryptAlgo{KeyGen}}
\newcommand{\Gen}{\styleCryptAlgo{Setup}}
\newcommand{\KGen}{\styleCryptAlgo{KeyGen}}
\newcommand{\Enc}{\styleCryptAlgo{Enc}}
\newcommand{\Dec}{\styleCryptAlgo{Dec}}
\newcommand{\Sign}{\styleCryptAlgo{Sign}}
\newcommand{\Verify}{\styleCryptAlgo{Verify}}
\newcommand{\Trapdoor}{\styleCryptAlgo{Trapdoor}}

\newcommand{\Eval}{\styleCryptAlgo{Eval}}
\newcommand{\PRG}{\styleCryptAlgo{PRG}}
\newcommand{\Hash}{\styleCryptAlgo{H}}

\newcommand{\Commit}{\styleCryptAlgo{Commit}}
\newcommand{\Prove}{\styleCryptAlgo{Prove}}
\newcommand{\prove}{\styleCryptAlgo{prove}}
\newcommand{\Answer}{\styleCryptAlgo{Answer}}
\newcommand{\Open}{\styleCryptAlgo{Open}}

% Zero-Knowledge Proofs, WI, etc
\newcommand{\Prover}{\styleCryptAlgo{P}}
\newcommand{\Verifier}{\styleCryptAlgo{V}}
\newcommand{\ProverS}{\styleCryptAlgo{P}_{\Sigma}}
\newcommand{\VerifierS}{\styleCryptAlgo{V}_{\Sigma}}
\newcommand{\Sender}{\styleCryptAlgo{S}}
\newcommand{\Receiver}{\styleCryptAlgo{R}}
\newcommand{\Sim}{\styleCryptAlgo{Sim}}
\newcommand{\Ext}{\styleCryptAlgo{Ext}}
\newcommand{\CRS}{\styleCryptAlgo{CRS}}

\newcommand{\ZK}{\stylePropertyAlgo{ZK}}
\newcommand{\zk}{\stylePropertyAlgo{zk}}
\newcommand{\ZKP}{\stylePropertyAlgo{ZKP}}
\newcommand{\ZKPoK}{\stylePropertyAlgo{ZKPoK}}
\newcommand{\WI}{\stylePropertyAlgo{WI}}
\newcommand{\HVZK}{\stylePropertyAlgo{HVZK}}
\newcommand{\NIZK}{\stylePropertyAlgo{NIZK}}
\newcommand{\NIZKs}{\stylePropertyAlgo{NIZKs}}
\newcommand{\NIWI}{\stylePropertyAlgo{NIWI}}

\newcommand{\Sigmap}{$\Sigma$-protocol\xspace}
\newcommand{\Sigmaps}{$\Sigma$-protocols\xspace}

% Symmetric crypto
\newcommand{\PRP}{\styleCryptAlgo{PRP}}
\newcommand{\CipherE}{\styleBlockCipher{E}}

% Notations
\newcommand{\pk}{\styleCryptVar{pk}}
\newcommand{\sk}{\styleCryptVar{sk}}
\newcommand{\ek}{\styleCryptVar{ek}}
\newcommand{\dk}{\styleCryptVar{dk}}
\newcommand{\vk}{\styleCryptVar{vk}}
\newcommand{\pvk}{\styleCryptVar{pvk}}
\newcommand{\PVK}{\styleCryptVar{PVK}}
\newcommand{\hk}{\styleCryptVar{hk}}

\newcommand{\aux}{\styleCryptVar{aux}}
\newcommand{\crs}{\styleCryptVar{crs}}
\newcommand{\com}{\styleCryptVar{com}}
\newcommand{\param}{\styleCryptVar{par}}
\newcommand{\trap}{\styleCryptVar{td}}

\newcommand{\statement}[1]{\styleSmallStateWit{#1}}
\newcommand{\statementx}{\statement{x}}
\newcommand{\witness}[1]{\styleSmallStateWit{#1}}
\newcommand{\witnessw}{\witness{w}}
\newcommand{\Statement}[1]{\styleBigStateWit{#1}}
\newcommand{\StatementX}{\Statement{X}}
\newcommand{\Witness}[1]{\styleBigStateWit{#1}}
\newcommand{\WitnessW}{\Witness{W}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Security Models
\newcommand{\INDCCA}{\styleSecurityModel{IND\text{-}CCA}}
\newcommand{\INDCPA}{\styleSecurityModel{IND\text{-}CPA}}

% Crypto sets and spaces
\newcommand{\setX}{\styleCryptSet{X}}
\newcommand{\setY}{\styleCryptSet{Y}}
\newcommand{\Keyspace}{\styleCryptSet{K}}

%--------------------------------------------------------
% Various
%--------------------------------------------------------

\newcommand{\map}{\ensuremath{\mathsf{map}}\xspace}
% \newcommand{\mode}{\mathsf{mode}} % Beamer not happy :'(
\newcommand{\token}{\ensuremath{\mathsf{token}}\xspace}
\newcommand{\seed}{\ensuremath{\mathsf{seed}}\xspace}
\newcommand{\inp}{\ensuremath{\mathsf{in}}\xspace}
\newcommand{\outp}{\ensuremath{\mathsf{out}}\xspace}
\newcommand{\circuit}{\ensuremath{\mathcal{C}}\xspace}
\newcommand{\size}[1]{\ensuremath{\left\vert #1 \right\vert}\xspace}
\newcommand{\myand}{\ensuremath{\mathsf{and}}\xspace}
\newcommand{\myxor}{\ensuremath{\mathsf{xor}}\xspace}
%\newcommand{\xor}{\mathbin{\mathsf{xor}}}
\newcommand{\mynot}{\ensuremath{\mathsf{not}}\xspace}
\newcommand{\Input}{\ensuremath{\mathsf{Input}}\xspace}
\newcommand{\pp}{\ensuremath{\mathsf{pp}}\xspace}

